DATE = @DATE@
VERSION = @VERSION@
RXVTNAME = @RXVTNAME@
SHELL = /bin/sh
prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
libdir = @libdir@
PODOPTS = quotes => q<"> , center => q<RXVT-UNICODE>, release => q<$(VERSION)>
CXX = @CXX@
PERL = @PERL@
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL@ -m 755
INSTALL_DATA = @INSTALL@ -m 644
CXXFLAGS = @CXXFLAGS@
CPPFLAGS = @CPPFLAGS@
LDFLAGS = @LDFLAGS@
DEFS = @DEFS@
LIBS = @LIBS@
XINC = @X_CFLAGS@ @PIXBUF_CFLAGS@ @STARTUP_NOTIFICATION_CFLAGS@
XLIB = @X_LIBS@ -lX11 @X_EXTRA_LIBS@ @PIXBUF_LIBS@ @STARTUP_NOTIFICATION_LIBS@
COMPILE = $(CXX) -I../include -I../ $(DEFS) $(CPPFLAGS) $(CXXFLAGS) $(XINC)
LINK = @LINKER@ $(LDFLAGS)
EXEEXT = @EXEEXT@
PERLFLAGS = @PERLFLAGS@
PERLLIB = @PERLLIB@

srcdir = @srcdir@
VPATH = @srcdir@

first_rule: all
dummy:

COMMON = \
	command.o display.o rxvtfont.o init.o main.o misc.o \
	screen.o scrollbar.o scrollbar-next.o scrollbar-rxvt.o \
	scrollbar-xterm.o scrollbar-plain.o encoding.o \
	rxvttoolkit.o rxvtutil.o keyboard.o rxvtimg.o \
	settings.o ev_cpp.o fdpass.o ptytty_logging.o \
	ptytty_proxy.o ptytty.o @PERL_O@

COMMON_DAEMON = connection.o

RXVT_BINNAME=$(DESTDIR)$(bindir)/$(RXVTNAME)$(EXEEXT)
RXVTC_BINNAME=$(DESTDIR)$(bindir)/$(RXVTNAME)c$(EXEEXT)
RXVTD_BINNAME=$(DESTDIR)$(bindir)/$(RXVTNAME)d$(EXEEXT)

#
# Distribution variables
#

.SUFFIXES:	.cpp .c .o

#-------------------------------------------------------------------------
# inference rules
.cpp.o:
	$(COMPILE) -c $<

#-------------------------------------------------------------------------

all: allbin

raxvt: rxvt.o $(COMMON)
	$(LINK) -o $@ rxvt.o $(COMMON) $(LIBS) $(XLIB) $(PERLLIB)

raxvtd: rxvtd.o $(COMMON) $(COMMON_DAEMON)
	$(LINK) -o $@ rxvtd.o $(COMMON) $(COMMON_DAEMON) $(LIBS) $(XLIB) $(PERLLIB)

raxvtc: rxvtc.o $(COMMON_DAEMON) fdpass.o
	$(LINK) -o $@ rxvtc.o $(COMMON_DAEMON) fdpass.o $(LIBS)

#-------------------------------------------------------------------------

#EXUBERANT_OPTS = -I NOTHROW -I THROW

tags: *.[Ch]
	ctags $(EXUBERANT_OPTS) *.[Ch]

TAGS: *.[Ch]
	etags $(EXUBERANT_OPTS) *.[Ch]

allbin: raxvt raxvtd raxvtc

alldoc:

clean:
	rm -f raxvt raxvtc raxvtd perlxsi.c rxvtperl.cpp manlst mantmp
	rm -f *.o

distclean: clean
	rm -f Makefile

realclean: distclean
	rm -f tags TAGS

cleandir: realclean

install-perl:
@IF_PERL@	$(INSTALL) -d $(DESTDIR)$(libdir)
@IF_PERL@	$(INSTALL) -d $(DESTDIR)$(libdir)/raxvt
@IF_PERL@	$(INSTALL) -d $(DESTDIR)$(libdir)/raxvt/perl
@IF_PERL@	$(INSTALL_DATA) $(srcdir)/raxvt.pm $(DESTDIR)$(libdir)/raxvt/raxvt.pm
@IF_PERL@	for ext in $(srcdir)/perl/*; do \
@IF_PERL@	   test -f "$$ext" || continue; \
@IF_PERL@	   $(INSTALL_DATA) "$$ext" $(DESTDIR)$(libdir)/raxvt/perl/; \
@IF_PERL@	done

install-bin: allbin
	$(INSTALL) -d $(DESTDIR)$(bindir)
	$(INSTALL_PROGRAM) raxvt  $(RXVT_BINNAME)
	$(INSTALL_PROGRAM) raxvtc $(RXVTC_BINNAME)
	$(INSTALL_PROGRAM) raxvtd $(RXVTD_BINNAME)

install: install-bin install-perl

perlxsi.c: Makefile
	$(PERL) -MExtUtils::Embed -e xsinit -- -std raxvt

rxvtperl.cpp: rxvtperl.xs iom_perl.h iom_perl.xs typemap typemap.iom
	PERL="$(PERL)" $(PERL) @PERLPRIVLIBEXP@/ExtUtils/xsubpp -C++ -typemap @PERLPRIVLIBEXP@/ExtUtils/typemap -typemap 'typemap.iom' -typemap 'typemap' -prototypes $(srcdir)/rxvtperl.xs >$@

rxvtperl.o: rxvtperl.cpp perlxsi.c
	$(COMPILE) $(PERLFLAGS) -DLIBDIR="\"$(libdir)/raxvt\"" -c $<

depend:
	makedepend -f Makefile.in -I. -I.. -I../include -Y *.cpp *.xs >/dev/null 2>&1

# DO NOT DELETE: nice dependency list follows

command.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
command.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h
command.o: ev_cpp.h ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h
command.o: scrollbar.h rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
command.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h version.h
command.o: command.h keyboard.h ../include/raxvt/display.hpp
connection.o: ../include/raxvt/connection.hpp
display.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
display.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h
display.o: ev_cpp.h ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h
display.o: scrollbar.h rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
display.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
display.o: ../include/raxvt/display.hpp
encoding.o: ../config.h encoding.h rxvtutil.h ./ecb.h ./estl.h ecb.h emman.h
encoding.o: table/iso8859_1.h table/iso8859_15.h table/iso8859_2.h
encoding.o: table/iso8859_3.h table/iso8859_4.h table/iso8859_5.h
encoding.o: table/iso8859_6.h table/iso8859_7.h table/iso8859_8.h
encoding.o: table/iso8859_9.h table/iso8859_10.h table/iso8859_11.h
encoding.o: table/iso8859_13.h table/iso8859_14.h table/iso8859_16.h
encoding.o: table/koi8_r.h table/koi8_u.h table/ksc5601_1987_0.h table/big5.h
encoding.o: table/gbk_0.h table/gb2312_1980_0.h table/cns11643_1992_1.h
encoding.o: table/cns11643_1992_2.h table/cns11643_1992_3.h
encoding.o: table/cns11643_1992_4.h table/cns11643_1992_5.h
encoding.o: table/cns11643_1992_6.h table/cns11643_1992_7.h
encoding.o: table/cns11643_1992_f.h table/big5_ext.h table/big5_plus.h
encoding.o: table/viscii.h table/jis0201_1976_0.h table/jis0208_1990_0.h
encoding.o: table/jis0212_1990_0.h table/jis0213_1.h table/jis0213_2.h
encoding.o: table/compose.h table/category.h
ev_cpp.o: ev_cpp.h ../config.h ./../deps/libev/ev++.h ./../deps/libev/ev.h
ev_cpp.o: ../deps/libev/ev.c ../deps/libev/ev_vars.h ../deps/libev/ev_epoll.c
ev_cpp.o: ../deps/libev/ev_select.c
fdpass.o: ../config.h libptytty.h
init.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
init.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h ev_cpp.h
init.o: ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h scrollbar.h
init.o: rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
init.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h init.h keyboard.h
init.o: ../include/raxvt/display.hpp ../include/raxvt/utils.hpp
keyboard.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
keyboard.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h
keyboard.o: ev_cpp.h ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h
keyboard.o: scrollbar.h rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
keyboard.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h keyboard.h
main.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
main.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h ev_cpp.h
main.o: ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h scrollbar.h
main.o: rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
main.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h init.h keyboard.h
main.o: ../include/raxvt/display.hpp ../include/raxvt/utils.hpp
misc.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
misc.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h ev_cpp.h
misc.o: ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h scrollbar.h
misc.o: rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
misc.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
ptytty.o: ../config.h ptytty.h libptytty.h ptytty_conf.h
ptytty_logging.o: ../config.h ptytty.h libptytty.h ptytty_conf.h
ptytty_proxy.o: ../config.h ptytty.h libptytty.h ptytty_conf.h estl.h ecb.h
rxvt.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
rxvt.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h ev_cpp.h
rxvt.o: ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h scrollbar.h
rxvt.o: rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
rxvt.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
rxvtc.o: ../config.h ./libptytty.h ../include/raxvt/connection.hpp
rxvtd.o: ../config.h ./libptytty.h rxvt.h feature.h ./ecb.h encoding.h
rxvtd.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h ev_cpp.h
rxvtd.o: ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h scrollbar.h
rxvtd.o: rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
rxvtd.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
rxvtd.o: ../include/raxvt/connection.hpp ../include/raxvt/display.hpp
rxvtfont.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
rxvtfont.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h
rxvtfont.o: ev_cpp.h ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h
rxvtfont.o: scrollbar.h rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
rxvtfont.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
rxvtfont.o: ../include/raxvt/display.hpp table/linedraw.h
rxvtimg.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
rxvtimg.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h
rxvtimg.o: ev_cpp.h ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h
rxvtimg.o: scrollbar.h rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
rxvtimg.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
rxvtimg.o: ../include/raxvt/display.hpp
rxvtperl.o: ../config.h ev_cpp.h ./../deps/libev/ev++.h ./../deps/libev/ev.h
rxvtperl.o: rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h rxvtutil.h
rxvtperl.o: ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h rxvtimg.h
rxvtperl.o: scrollbar.h rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
rxvtperl.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h keyboard.h
rxvtperl.o: ../include/raxvt/display.hpp perlxsi.c iom_perl.h
rxvttoolkit.o: ../config.h ./rxvt.h feature.h ./ecb.h ./libptytty.h
rxvttoolkit.o: encoding.h rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h
rxvttoolkit.o: rxvttoolkit.h ev_cpp.h ./../deps/libev/ev++.h
rxvttoolkit.o: ./../deps/libev/ev.h rxvtimg.h scrollbar.h rxvtperl.h
rxvttoolkit.o: hookinc.h ../include/raxvt/selection.hpp
rxvttoolkit.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
rxvttoolkit.o: ./rxvttoolkit.h ../include/raxvt/display.hpp
rxvtutil.o: ./emman.c emman.h rxvtutil.h ./ecb.h ./estl.h ecb.h
rxvtutil.o: ../include/raxvt/utils.hpp
screen.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
screen.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h ev_cpp.h
screen.o: ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h scrollbar.h
screen.o: rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
screen.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
screen.o: ../include/raxvt/display.hpp
scrollbar-next.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h
scrollbar-next.o: encoding.h rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h
scrollbar-next.o: rxvttoolkit.h ev_cpp.h ./../deps/libev/ev++.h
scrollbar-next.o: ./../deps/libev/ev.h rxvtimg.h scrollbar.h rxvtperl.h
scrollbar-next.o: hookinc.h ../include/raxvt/selection.hpp
scrollbar-next.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
scrollbar-plain.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h
scrollbar-plain.o: encoding.h rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h
scrollbar-plain.o: rxvttoolkit.h ev_cpp.h ./../deps/libev/ev++.h
scrollbar-plain.o: ./../deps/libev/ev.h rxvtimg.h scrollbar.h rxvtperl.h
scrollbar-plain.o: hookinc.h ../include/raxvt/selection.hpp
scrollbar-plain.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
scrollbar-rxvt.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h
scrollbar-rxvt.o: encoding.h rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h
scrollbar-rxvt.o: rxvttoolkit.h ev_cpp.h ./../deps/libev/ev++.h
scrollbar-rxvt.o: ./../deps/libev/ev.h rxvtimg.h scrollbar.h rxvtperl.h
scrollbar-rxvt.o: hookinc.h ../include/raxvt/selection.hpp
scrollbar-rxvt.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
scrollbar-xterm.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h
scrollbar-xterm.o: encoding.h rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h
scrollbar-xterm.o: rxvttoolkit.h ev_cpp.h ./../deps/libev/ev++.h
scrollbar-xterm.o: ./../deps/libev/ev.h rxvtimg.h scrollbar.h rxvtperl.h
scrollbar-xterm.o: hookinc.h ../include/raxvt/selection.hpp
scrollbar-xterm.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
scrollbar.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
scrollbar.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h
scrollbar.o: ev_cpp.h ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h
scrollbar.o: scrollbar.h rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
scrollbar.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h
settings.o: ../config.h rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h
settings.o: rxvtutil.h ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h
settings.o: ev_cpp.h ./../deps/libev/ev++.h ./../deps/libev/ev.h rxvtimg.h
settings.o: scrollbar.h rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
settings.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h version.h
settings.o: ./../deps/tinytoml/include/toml/toml.h keyboard.h
rxvtperl.o: ../config.h ev_cpp.h ./../deps/libev/ev++.h ./../deps/libev/ev.h
rxvtperl.o: rxvt.h feature.h ./ecb.h ./libptytty.h encoding.h rxvtutil.h
rxvtperl.o: ./estl.h ecb.h emman.h rxvtfont.h rxvttoolkit.h rxvtimg.h
rxvtperl.o: scrollbar.h rxvtperl.h hookinc.h ../include/raxvt/selection.hpp
rxvtperl.o: ../include/raxvt/coordinates.hpp rsinc.h optinc.h keyboard.h
rxvtperl.o: ../include/raxvt/display.hpp perlxsi.c iom_perl.h
